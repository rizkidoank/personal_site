<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Rizki Rizki">
    <meta name="description" content="MySQL atau MariaDB seringkali digunakan untuk DBMS relasional. Pada penggunaan pribadi atau skala kecil menengah, satu instance MySQL atau MariaDB sudah cukup untuk memenuhi kebutuhan. Namun, pada skala besar, seringkali ditemukan kendala seperti tidak mampu menangani rekues, eksekusi kueri yang lambat, dan lain-lain.
Dalam menanggapi permasalahan tersebut, terdapat beberapa solusi yang dapat diterapkan antara lain tuning di DBMS,tuning di level sistem operasi, scale-up,atau load balancing. Pada tulisan ini saya akan mencoba melakukan load balancing MariaDB.">
    <meta name="keywords" content="blog,developer,personal,devops">

    

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MariaDB Load Balancing"/>
<meta name="twitter:description" content="MySQL atau MariaDB seringkali digunakan untuk DBMS relasional. Pada penggunaan pribadi atau skala kecil menengah, satu instance MySQL atau MariaDB sudah cukup untuk memenuhi kebutuhan. Namun, pada skala besar, seringkali ditemukan kendala seperti tidak mampu menangani rekues, eksekusi kueri yang lambat, dan lain-lain.
Dalam menanggapi permasalahan tersebut, terdapat beberapa solusi yang dapat diterapkan antara lain tuning di DBMS,tuning di level sistem operasi, scale-up,atau load balancing. Pada tulisan ini saya akan mencoba melakukan load balancing MariaDB."/>

    <meta property="og:title" content="MariaDB Load Balancing" />
<meta property="og:description" content="MySQL atau MariaDB seringkali digunakan untuk DBMS relasional. Pada penggunaan pribadi atau skala kecil menengah, satu instance MySQL atau MariaDB sudah cukup untuk memenuhi kebutuhan. Namun, pada skala besar, seringkali ditemukan kendala seperti tidak mampu menangani rekues, eksekusi kueri yang lambat, dan lain-lain.
Dalam menanggapi permasalahan tersebut, terdapat beberapa solusi yang dapat diterapkan antara lain tuning di DBMS,tuning di level sistem operasi, scale-up,atau load balancing. Pada tulisan ini saya akan mencoba melakukan load balancing MariaDB." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://rizkidoank.com/2016/10/13/mariadb-load-balancing/" />
<meta property="article:published_time" content="2016-10-13T03:40:00+00:00" />
<meta property="article:modified_time" content="2016-10-13T03:40:00+00:00" />


    
      <base href="https://rizkidoank.com/2016/10/13/mariadb-load-balancing/">
    
    <title>
  MariaDB Load Balancing · rizkidoank&#39;s Blog
</title>

    
      <link rel="canonical" href="https://rizkidoank.com/2016/10/13/mariadb-load-balancing/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.3219ef62ae52679b7a9c19043171c3cd9f523628c2a65f3ef247ee18836bc90b.css" integrity="sha256-MhnvYq5SZ5t6nBkEMXHDzZ9SNijCpl8&#43;8kfuGINryQs=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    <link rel="icon" type="image/png" href="https://rizkidoank.com/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://rizkidoank.com/images/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.72.0" />
  </head>

  
  
  <body class="colorscheme-light"
        onload=""
  >
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      rizkidoank&#39;s Blog
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://rizkidoank.com/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://rizkidoank.com/about/">About</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">MariaDB Load Balancing</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2016-10-13T03:40:00Z'>
                October 13, 2016
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              2-minute read
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="/tags/sysadmin/">sysadmin</a>
      <span class="separator">•</span>
    <a href="/tags/server/">server</a>
      <span class="separator">•</span>
    <a href="/tags/networking/">networking</a>
      <span class="separator">•</span>
    <a href="/tags/service/">service</a></div>

        </div>
      </header>

      <div>
        
        <p>MySQL atau MariaDB seringkali digunakan untuk DBMS relasional. Pada penggunaan pribadi atau skala kecil menengah, satu instance MySQL atau MariaDB sudah cukup untuk memenuhi kebutuhan. Namun, pada skala besar, seringkali ditemukan kendala seperti tidak mampu menangani rekues, eksekusi kueri yang lambat, dan lain-lain.</p>
<p>Dalam menanggapi permasalahan tersebut, terdapat beberapa solusi yang dapat diterapkan antara lain tuning di DBMS,tuning di level sistem operasi, scale-up,atau load balancing. Pada tulisan ini saya akan mencoba melakukan load balancing MariaDB.</p>
<h3 id="requirements">Requirements</h3>
<p>Perangkat yang digunakan yaitu dua host MariaDB, dan satu host load-balancer, dalam kasus ini saya manfaatkan HA-Proxy. Konfigurasi saya lakukan pada mesin virtual dengan sistem operasi Alpine Linux.</p>
<h3 id="pemasangan-mariadb">Pemasangan MariaDB</h3>
<p>MariaDB server akan dipasang di dua host, sedangkan host load-balancer akan dipasangkan HA-Proxy dan MariaDB client. Berikut langkah pemasangannya untuk di server mariadb.</p>
<pre><code>apk update &amp;&amp; apk add mariadb mariadb-client # di host mariadb
</code></pre>
<p>Sedangkan untuk di load-balancer sebagai berikut.</p>
<pre><code>apk update &amp;&amp; apk add haproxy mariadb-client # di host load balancer
</code></pre>
<p><img src="https://rizkidoank.sgp1.digitaloceanspaces.com/rizkidoank/images/2016/10/mariadb_load_01.jpeg" alt=""></p>
<p>Selanjutnya, lakukan konfigurasi pada DBMS dan jalankan DBMS. Masuk ke DBMS dan jalankan kueri berikut untuk pengecekan status server oleh haproxy.</p>
<pre><code>INSERT INTO mysql.user (Host,User) values ('&lt;IP_HAPROXY&gt;','balancer_check');
GRANT ALL PRIVILEGES ON *.* TO 'balancer'@'&lt;IP_HAPROXY&gt;' IDENTIFIED BY 'password' WITH GRANT OPTION;
FLUSH PRIVILEGES;&quot;
</code></pre>
<h3 id="konfigurasi-ha-proxy">Konfigurasi HA-Proxy</h3>
<p>Setelah konfigurasi DBMS, kini DBMS dapat diakses melalui host balancer. Langkah selanjutnya yaitu konfigurasi load balancer, saya ubah konfigurasi pada <code>/etc/haproxy/haproxy.cfg</code> menjadi seperti berikut :</p>
<pre><code>global
    log 127.0.0.1 local0 notice
    user haproxy
    group haproxy

defaults
    log global
    retries 2
    timeout connect 1000
    timeout server 1000
    timeout client 1000

listen maria-cluster
    bind 127.0.0.1:3306
    mode tcp
    option mysql-check user balancer_check
    balance roundrobin
    server n01 &lt;IP_DB_HOST1&gt;:3306 check
    server n02 &lt;IP_DB_HOST2&gt;:3306 check
</code></pre>
<p>Selanjutnya, restart haproxy dan konfigurasi selesai. Konfigurasi diatas tidak menyediakan laman status cluster, hanya menyediakan load balancing-nya saja. Jika ingin menambahkan laman status cluster, dapat ditambahkan konfigurasinya di <code>haproxy.cfg</code>.</p>
<h3 id="pengujian-load-balancing">Pengujian Load Balancing</h3>
<p>Setelah konfigurasi selesai, saya coba akses MariaDB dengan load-balancing di host haproxy.</p>
<pre><code>mysql -h 127.0.0.1 -u balancer -p
</code></pre>
<p>Jika konfigurasinya benar,maka akan muncul prompt input kueri. Pengujian selanjutnya yaitu dengan eksekusi kueri bersamaan (concurrent).</p>
<p><img src="https://rizkidoank.sgp1.digitaloceanspaces.com/rizkidoank/images/2016/10/mariadb_load_02.jpeg" alt=""></p>
<p>Dari gambar diatas dapat disimpulkan load balancing sudah berfungsi dengan algoritma balancing roundrobin tanpa bobot. Selamat mencoba dan silakan informasikan jika ada yang kurang tepat. :D</p>

      </div>


      <footer>
        


        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "rizkidoank" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
        
      </footer>
    </article>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js" id="MathJax-script"></script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [
          ['$', '$'], ['\\(', '\\)']
        ],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
  </script>
  </section>

      </div>

      
  <footer class="footer">
    <section class="container">
      
      
        ©
        
        2020
         Rizki Rizki 
      
      
         · 
        Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
      
      
        
      
    </section>
  </footer>

    </main>

    

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-78100671-2', 'auto');
	
	ga('send', 'pageview');
}
</script>


    

  </body>

</html>
